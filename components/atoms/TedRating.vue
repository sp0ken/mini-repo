<template>
  <div
    v-if="roundedTooltip"
    class="ted-rating tooltip d-flex"
    :data-tooltip="$n(roundedTooltip, { locale: 'fr-FR', maximumFractionDigits: 1 })"
  >
    <svg
      width="119px"
      height="24px"
      viewBox="0 0 119 24"
      version="1.1"
      xmlns="http://www.w3.org/2000/svg"
      xmlns:xlink="http://www.w3.org/1999/xlink"
    >
      <defs>
        <linearGradient :id="`linearGradient-${$n(time)}`" :x1="percentCalc" y1="1" x2="1.1" y2="1">
          <stop stop-color="#FAB200" />
          <stop stop-color="#D8D8D8" stop-opacity="0" />
        </linearGradient>
      </defs>
      <g
        id="Page-1"
        stroke="none"
        stroke-width="1"
        fill="none"
        fill-rule="evenodd"
        stroke-linecap="round"
        stroke-linejoin="round"
      >
        <g
          id="Group"
          transform="translate(1, -1)"
          :fill="`url(#linearGradient-${$n(time)})`"
          stroke="#FAB200"
          stroke-width="2"
        >
          <path
            id="Combined-Shape"
            d="M85.0166849,0.991740696 L85.1319083,0.991740696 L85.2319707,1.0523846 C85.7383473,1.3556041 85.7565405,1.89230263 85.7717015,2.26526262 L85.7717015,2.46841969 L85.7717015,2.46841969 C85.9324078,4.1755455 86.0264058,6.00395912 86.0567278,8.04765858 C86.074921,9.2605366 86.074921,9.2605366 86.4842673,9.34847026 C86.6692312,9.3878888 86.9027102,9.41821075 87.1907687,9.46066148 C87.9852038,9.57285269 88.7311238,9.64562538 89.480076,9.71839806 C90.9581909,9.8256352 92.4253826,10.050733 93.8676622,10.3915454 L94.1344954,10.464318 L94.2072681,10.7311512 C94.3753539,11.2337298 94.1172084,11.7794466 93.6220544,11.9682868 C93.5765696,11.9899024 93.5329583,12.0152578 93.4916701,12.0440917 C92.7554348,12.5491691 91.9738027,12.9846498 91.1568799,13.3449033 C90.5116467,13.6317656 89.8865935,13.9620206 89.2860155,14.3333989 L88.9494419,14.5547492 C88.718995,14.7124233 88.485516,14.8579687 88.2429404,15.0004818 C87.9397209,15.158156 87.9003024,15.1975745 87.9791395,15.5493091 C88.0701053,15.9677521 88.1489424,16.3831628 88.2277794,16.7955413 C88.485516,18.1479003 88.7280916,19.4244544 89.2920799,20.6130749 C89.5414918,21.1010995 89.5872872,21.6680894 89.4194321,22.1898163 L89.2860155,22.6749675 L88.8069287,22.5203256 C87.6486302,22.1473656 86.5358146,21.7380192 85.6413171,20.8708115 C85.1337888,20.4201822 84.5701938,20.0369783 83.9645132,19.7307061 C83.5120445,19.4856661 83.0755458,19.2122215 82.6576371,18.9120135 C82.5697035,18.8756271 82.499963,18.9120135 82.3210635,19.0423978 C81.5599825,19.6245793 80.7473543,20.1339881 79.9589835,20.6282359 C79.0214128,21.1877062 78.1219155,21.8086429 77.2663943,22.4869714 C77.038447,22.7574623 76.6898369,22.8953114 76.3385426,22.853867 C76.2522456,22.835625 76.1693606,22.8039035 76.0929348,22.759869 L75.9504217,22.6416134 C75.682566,22.2816862 75.682566,21.7886625 75.9504217,21.4287354 C76.6466038,20.0726039 77.2543122,18.6728489 77.7697387,17.2382418 C77.960767,16.7470262 78.1517953,16.2527784 78.3519202,15.764595 L78.5004977,15.4098282 C78.8037172,14.6821014 78.8037172,14.6821014 77.9425738,14.2545619 C77.3937465,13.9907609 76.8631124,13.6754126 76.3506714,13.3691609 C75.6553389,12.9200567 74.9193192,12.5373264 74.15233,12.2260234 C73.5427612,12.0427195 73.0685047,11.5616063 72.8939691,10.9494692 L72.7726813,10.5188976 L73.2002208,10.3672878 C74.0575754,10.0810832 74.9445859,9.89289866 75.8442949,9.80633171 L76.9995612,9.66078635 C78.1123768,9.51827318 79.2282245,9.37576002 80.3349757,9.26660099 C80.7291611,9.22718246 80.9019962,9.10892685 81.1445718,8.47823028 C81.8116547,6.78020105 82.5484781,5.07307524 83.2671083,3.42356113 L84.0372859,1.63456605 C84.1758537,1.21961467 84.5808575,0.953791741 85.0166849,0.991740696 Z M12.2440036,0.991740696 L12.359227,0.991740696 L12.4592895,1.0523846 C12.965666,1.3556041 12.9838592,1.89230263 12.9990202,2.26526262 L12.9990202,2.46841969 L12.9990202,2.46841969 C13.1597265,4.1755455 13.2537246,6.00395912 13.2840465,8.04765858 C13.3022397,9.2605366 13.3022397,9.2605366 13.711586,9.34847026 C13.8965499,9.3878888 14.1300289,9.41821075 14.4180875,9.46066148 C15.2125226,9.57285269 15.9584426,9.64562538 16.7073947,9.71839806 C18.1855097,9.8256352 19.6527014,10.050733 21.094981,10.3915454 L21.3618141,10.464318 L21.4345868,10.7311512 C21.6026726,11.2337298 21.3445271,11.7794466 20.8493732,11.9682868 C20.8038883,11.9899024 20.760277,12.0152578 20.7189888,12.0440917 C19.9827536,12.5491691 19.2011215,12.9846498 18.3841986,13.3449033 C17.7389654,13.6317656 17.1139122,13.9620206 16.5133343,14.3333989 L16.1767606,14.5547492 C15.9463138,14.7124233 15.7128348,14.8579687 15.4702592,15.0004818 C15.1670397,15.158156 15.1276211,15.1975745 15.2064582,15.5493091 C15.297424,15.9677521 15.3762611,16.3831628 15.4550982,16.7955413 C15.7128348,18.1479003 15.9554104,19.4244544 16.5193986,20.6130749 C16.7688106,21.1010995 16.8146059,21.6680894 16.6467508,22.1898163 L16.5133343,22.6749675 L16.0342474,22.5203256 C14.8759489,22.1473656 13.7631333,21.7380192 12.8686358,20.8708115 C12.3611076,20.4201822 11.7975125,20.0369783 11.1918319,19.7307061 C10.7393632,19.4856661 10.3028646,19.2122215 9.88495587,18.9120135 C9.79702222,18.8756271 9.72728173,18.9120135 9.54838222,19.0423978 C8.78730126,19.6245793 7.97467299,20.1339881 7.18630227,20.6282359 C6.24873149,21.1877062 5.34923424,21.8086429 4.49371307,22.4869714 C4.26576575,22.7574623 3.91715567,22.8953114 3.56586138,22.853867 C3.47956438,22.835625 3.39667938,22.8039035 3.32025358,22.759869 L3.17774042,22.6416134 C2.90988477,22.2816862 2.90988477,21.7886625 3.17774042,21.4287354 C3.8739225,20.0726039 4.48163089,18.6728489 4.99705745,17.2382418 C5.18808574,16.7470262 5.37911402,16.2527784 5.5792389,15.764595 L5.72781645,15.4098282 C6.03103596,14.6821014 6.03103596,14.6821014 5.16989256,14.2545619 C4.62106526,13.9907609 4.09043113,13.6754126 3.57799016,13.3691609 C2.8826576,12.9200567 2.1466379,12.5373264 1.37964875,12.2260234 C0.770079895,12.0427195 0.295823428,11.5616063 0.121287802,10.9494692 L1.03028697e-13,10.5188976 L0.427539502,10.3672878 C1.28489411,10.0810832 2.17190467,9.89289866 3.07161359,9.80633171 L4.2268799,9.66078635 C5.33969549,9.51827318 6.45554327,9.37576002 7.56229446,9.26660099 C7.95647982,9.22718246 8.12931494,9.10892685 8.37189054,8.47823028 C9.03897345,6.78020105 9.77579685,5.07307524 10.4944271,3.42356113 L11.2646046,1.63456605 C11.4031724,1.21961467 11.8081762,0.953791741 12.2440036,0.991740696 Z M36.501564,0.991740696 L36.6167875,0.991740696 L36.7168499,1.0523846 C37.2232265,1.3556041 37.2414196,1.89230263 37.2565806,2.26526262 L37.2565806,2.46841969 L37.2565806,2.46841969 C37.417287,4.1755455 37.511285,6.00395912 37.5416069,8.04765858 C37.5598001,9.2605366 37.5598001,9.2605366 37.9691465,9.34847026 C38.1541103,9.3878888 38.3875894,9.41821075 38.6756479,9.46066148 C39.470083,9.57285269 40.216003,9.64562538 40.9649552,9.71839806 C42.4430701,9.8256352 43.9102618,10.050733 45.3525414,10.3915454 L45.6193746,10.464318 L45.6921472,10.7311512 C45.860233,11.2337298 45.6020875,11.7794466 45.1069336,11.9682868 C45.0614487,11.9899024 45.0178374,12.0152578 44.9765492,12.0440917 C44.240314,12.5491691 43.4586819,12.9846498 42.641759,13.3449033 C41.9965259,13.6317656 41.3714727,13.9620206 40.7708947,14.3333989 L40.434321,14.5547492 C40.2038742,14.7124233 39.9703952,14.8579687 39.7278196,15.0004818 C39.4246001,15.158156 39.3851815,15.1975745 39.4640186,15.5493091 C39.5549845,15.9677521 39.6338215,16.3831628 39.7126586,16.7955413 C39.9703952,18.1479003 40.2129708,19.4244544 40.7769591,20.6130749 C41.026371,21.1010995 41.0721663,21.6680894 40.9043113,22.1898163 L40.7708947,22.6749675 L40.2918079,22.5203256 C39.1335094,22.1473656 38.0206938,21.7380192 37.1261962,20.8708115 C36.618668,20.4201822 36.055073,20.0369783 35.4493924,19.7307061 C34.9969236,19.4856661 34.560425,19.2122215 34.1425163,18.9120135 C34.0545826,18.8756271 33.9848422,18.9120135 33.8059426,19.0423978 C33.0448617,19.6245793 32.2322334,20.1339881 31.4438627,20.6282359 C30.5062919,21.1877062 29.6067947,21.8086429 28.7512735,22.4869714 C28.5233262,22.7574623 28.1747161,22.8953114 27.8234218,22.853867 C27.7371248,22.835625 27.6542398,22.8039035 27.577814,22.759869 L27.4353008,22.6416134 C27.1674452,22.2816862 27.1674452,21.7886625 27.4353008,21.4287354 C28.1314829,20.0726039 28.7391913,18.6728489 29.2546179,17.2382418 C29.4456462,16.7470262 29.6366744,16.2527784 29.8367993,15.764595 L29.9853769,15.4098282 C30.2885964,14.6821014 30.2885964,14.6821014 29.427453,14.2545619 C28.8786257,13.9907609 28.3479915,13.6754126 27.8355506,13.3691609 C27.140218,12.9200567 26.4041983,12.5373264 25.6372092,12.2260234 C25.0276403,12.0427195 24.5533838,11.5616063 24.3788482,10.9494692 L24.2575604,10.5188976 L24.6850999,10.3672878 C25.5424545,10.0810832 26.4294651,9.89289866 27.329174,9.80633171 L28.4844403,9.66078635 C29.5972559,9.51827318 30.7131037,9.37576002 31.8198549,9.26660099 C32.2140402,9.22718246 32.3868754,9.10892685 32.629451,8.47823028 C33.2965339,6.78020105 34.0333573,5.07307524 34.7519875,3.42356113 L35.522165,1.63456605 C35.6607328,1.21961467 36.0657366,0.953791741 36.501564,0.991740696 Z M60.7591245,0.991740696 L60.8743479,0.991740696 L60.9744103,1.0523846 C61.4807869,1.3556041 61.4989801,1.89230263 61.514141,2.26526262 L61.514141,2.46841969 L61.514141,2.46841969 C61.6748474,4.1755455 61.7688454,6.00395912 61.7991674,8.04765858 C61.8173605,9.2605366 61.8173605,9.2605366 62.2267069,9.34847026 C62.4116708,9.3878888 62.6451498,9.41821075 62.9332083,9.46066148 C63.7276434,9.57285269 64.4735634,9.64562538 65.2225156,9.71839806 C66.7006305,9.8256352 68.1678222,10.050733 69.6101018,10.3915454 L69.876935,10.464318 L69.9497077,10.7311512 C70.1177934,11.2337298 69.859648,11.7794466 69.364494,11.9682868 C69.3190092,11.9899024 69.2753979,12.0152578 69.2341096,12.0440917 C68.4978744,12.5491691 67.7162423,12.9846498 66.8993194,13.3449033 C66.2540863,13.6317656 65.6290331,13.9620206 65.0284551,14.3333989 L64.6918814,14.5547492 C64.4614346,14.7124233 64.2279556,14.8579687 63.98538,15.0004818 C63.6821605,15.158156 63.642742,15.1975745 63.721579,15.5493091 C63.8125449,15.9677521 63.891382,16.3831628 63.970219,16.7955413 C64.2279556,18.1479003 64.4705312,19.4244544 65.0345195,20.6130749 C65.2839314,21.1010995 65.3297268,21.6680894 65.1618717,22.1898163 L65.0284551,22.6749675 L64.5493683,22.5203256 C63.3910698,22.1473656 62.2782542,21.7380192 61.3837566,20.8708115 C60.8762284,20.4201822 60.3126334,20.0369783 59.7069528,19.7307061 C59.2544841,19.4856661 58.8179854,19.2122215 58.4000767,18.9120135 C58.3121431,18.8756271 58.2424026,18.9120135 58.0635031,19.0423978 C57.3024221,19.6245793 56.4897938,20.1339881 55.7014231,20.6282359 C54.7638523,21.1877062 53.8643551,21.8086429 53.0088339,22.4869714 C52.7808866,22.7574623 52.4322765,22.8953114 52.0809822,22.853867 C51.9946852,22.835625 51.9118002,22.8039035 51.8353744,22.759869 L51.6928613,22.6416134 C51.4250056,22.2816862 51.4250056,21.7886625 51.6928613,21.4287354 C52.3890433,20.0726039 52.9967517,18.6728489 53.5121783,17.2382418 C53.7032066,16.7470262 53.8942349,16.2527784 54.0943597,15.764595 L54.2429373,15.4098282 C54.5461568,14.6821014 54.5461568,14.6821014 53.6850134,14.2545619 C53.1361861,13.9907609 52.605552,13.6754126 52.093111,13.3691609 C51.3977784,12.9200567 50.6617587,12.5373264 49.8947696,12.2260234 C49.2852007,12.0427195 48.8109443,11.5616063 48.6364086,10.9494692 L48.5151208,10.5188976 L48.9426603,10.3672878 C49.800015,10.0810832 50.6870255,9.89289866 51.5867344,9.80633171 L52.7420007,9.66078635 C53.8548163,9.51827318 54.9706641,9.37576002 56.0774153,9.26660099 C56.4716007,9.22718246 56.6444358,9.10892685 56.8870114,8.47823028 C57.5540943,6.78020105 58.2909177,5.07307524 59.0095479,3.42356113 L59.7797255,1.63456605 C59.9182932,1.21961467 60.323297,0.953791741 60.7591245,0.991740696 Z M107.758148,0.991740696 L107.873371,0.991740696 L107.973434,1.0523846 C108.47981,1.3556041 108.498003,1.89230263 108.513164,2.26526262 L108.513164,2.46841969 L108.513164,2.46841969 C108.673871,4.1755455 108.767869,6.00395912 108.798191,8.04765858 C108.816384,9.2605366 108.816384,9.2605366 109.22573,9.34847026 C109.410694,9.3878888 109.644173,9.41821075 109.932232,9.46066148 C110.726667,9.57285269 111.472587,9.64562538 112.221539,9.71839806 C113.699654,9.8256352 115.166846,10.050733 116.609125,10.3915454 L116.875958,10.464318 L116.948731,10.7311512 C117.116817,11.2337298 116.858671,11.7794466 116.363517,11.9682868 C116.318032,11.9899024 116.274421,12.0152578 116.233133,12.0440917 C115.496898,12.5491691 114.715266,12.9846498 113.898343,13.3449033 C113.25311,13.6317656 112.628056,13.9620206 112.027478,14.3333989 L111.690905,14.5547492 C111.460458,14.7124233 111.226979,14.8579687 110.984403,15.0004818 C110.681184,15.158156 110.641765,15.1975745 110.720602,15.5493091 C110.811568,15.9677521 110.890405,16.3831628 110.969242,16.7955413 C111.226979,18.1479003 111.469555,19.4244544 112.033543,20.6130749 C112.282955,21.1010995 112.32875,21.6680894 112.160895,22.1898163 L112.027478,22.6749675 L111.548392,22.5203256 C110.390093,22.1473656 109.277278,21.7380192 108.38278,20.8708115 C107.875252,20.4201822 107.311657,20.0369783 106.705976,19.7307061 C106.253507,19.4856661 105.817009,19.2122215 105.3991,18.9120135 C105.311166,18.8756271 105.241426,18.9120135 105.062526,19.0423978 C104.301445,19.6245793 103.488817,20.1339881 102.700446,20.6282359 C101.762876,21.1877062 100.863378,21.8086429 100.007857,22.4869714 C99.7799099,22.7574623 99.4312998,22.8953114 99.0800055,22.853867 C98.9937085,22.835625 98.9108235,22.8039035 98.8343977,22.759869 L98.6918846,22.6416134 C98.4240289,22.2816862 98.4240289,21.7886625 98.6918846,21.4287354 C99.3880667,20.0726039 99.9957751,18.6728489 100.511202,17.2382418 C100.70223,16.7470262 100.893258,16.2527784 101.093383,15.764595 L101.241961,15.4098282 C101.54518,14.6821014 101.54518,14.6821014 100.684037,14.2545619 C100.135209,13.9907609 99.6045753,13.6754126 99.0921343,13.3691609 C98.3968018,12.9200567 97.6607821,12.5373264 96.8937929,12.2260234 C96.2842241,12.0427195 95.8099676,11.5616063 95.635432,10.9494692 L95.5141442,10.5188976 L95.9416837,10.3672878 C96.7990383,10.0810832 97.6860488,9.89289866 98.5857577,9.80633171 L99.7410241,9.66078635 C100.85384,9.51827318 101.969687,9.37576002 103.076439,9.26660099 C103.470624,9.22718246 103.643459,9.10892685 103.886035,8.47823028 C104.553118,6.78020105 105.289941,5.07307524 106.008571,3.42356113 L106.778749,1.63456605 C106.917317,1.21961467 107.32232,0.953791741 107.758148,0.991740696 Z"
          />
        </g>
      </g>
    </svg>
  </div>
</template>

<script>
  export default {
    props: {
      rating: {
        type: Number,
        required: true
      }
    },

    data() {
      return {
        time: new Date()
      }
    },

    computed: {
      /**
       * Returns the rounded rating
       *
       * @return Number
       */
      roundedTooltip: function() {
        if (typeof this.rating === 'number') {
          return this.rating.toFixed(1)
        } else {
          return 4.6
        }
      },

      /**
       * Returns the rating as a percentage
       *
       * @return Number
       */
      percentCalc: function() {
        let rating = typeof this.rating === 'number' ? this.rating / 5 : 4.6 / 5
        rating = Number.parseFloat(rating)

        if (rating < 1) {
          // Slight boost to be more visually consistent with the svg
          rating = rating + 0.02
        }

        return rating.toFixed(2)
      }
    }
  }
</script>

<style lang="scss">
  .ted-rating {
    flex-wrap: nowrap;
  }
</style>
